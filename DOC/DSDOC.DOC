




     ЕЕЕЕЕЕЕЕЕЕ  СССССССССС         ЭЭЭЭЭЭЭЭЭ   ВВВВВВВВВВ  М        М
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ      ММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  МММ    МММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММММ  ММММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ ММММ ММ
     ЕЕЕЕЕЕЕ     СС                    ЭЭЭЭЭЭЭ  ВВВВВВВВВВ  ММ  ММ  ММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ      ММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ      ММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ      ММ
     ЕЕ          СС                         ЭЭ  ВВ      ВВ  ММ      ММ
     ЕЕЕЕЕЕЕЕЕЕ  СССССССССС         ЭЭЭЭЭЭЭЭЭ   ВВВВВВВВВВ  ММ      ММ









                             ЭМУЛЯТОР ЕС ЭВМ

                  (то ли РУКОВОДСТВО то ли USER'S ...)

















                                              Добрянский А.Б.
                                              DSSoft Ltd.
                                              & НПО "НОСТАЛЬГИЯ"




                               С-Петербург
                             январь 1995 г.























         В  старое  доброе  время,  когда  еще  не было компьютеров, а
    работали  Электронно  Вычислительные   Машины.  Когда  для   вноса
    гениально создраных ЕС на  второй этаж было проще  разобрать стену
    оконного  проема  и  воспользоваться  услугами  автокрана.   Когда
    настоящий  программист  программировал  на  Фортране  и в качестве
    знаков  различия   предпочитал  тапочки.   Когда  программы   были
    программами - твердыми и  весомыми, а не СОФТОМ.  Когда Начальника
    ЭВМ звали Клавдия  Ивановна, она была  нашего возраста и  запросто
    откликалась на  имя Клава.  Все-Все мы  мечтали, что  когда-нибудь
    очередное изделие  зарубежной фирмы  (где-то там  в Минске)  будет
    маленькое,  изящное  и  компактное  настолько,  что  можно   будет
    пригласить  только  двух  своих  друзей,  чтобы  компьютер сделать
    персональным.

    The time was gone.






































                     Содержание (don't RFM, please)

       Введение, технические характеристики

    1. Установка программного обеспечения
       1.а Защита от несанкционированного использования

    2. Настройка файла праметров INIT360.PRM

    3. Назначение рабочих файлов

    4. Запуск эмулятора и переключение работы его режимов
       4.а Режим эмуляции пульта ЭВМ
       4.б Режим эмуляции консоли оператора (П/М)
       4.в Режим эмуляции дисплея 7920


    5. Переброска программного обеспечения с ЕС ЭВМ в эмулятор
       5.а Подготовка эмулируемых дисков
       5.а Переброска дисковых носителей
       5.б Переброска файлов на магнитной ленте
       5.в Программа формирования дескрипторов на ЕС ЭВМ
       5.г Программа преобразования двоичного файла в формат
           эмулируемой ленты



























                  Введение, технические характеристики
                  ====================================



         Эмулятор  ЕС  ЭВМ,  в  дальнейшем  ЭМУЛЯТОР, предназначен для
    полного  моделирования  работы  ЕС  ЭВМ на персональном компьютере
    класса  386/486.  Под  моделированием  понимается  ПОЛНАЯ эмуляции
    всего  программного   обеспечения,  разработанного   на  "больших"
    компьютерах.

         Версия 1.5 от января  1995 эмулирует следующее:

         процессор IBM 360 - в полном объеме;

         команды IBM 370 - частичная;

         дисковые устройства 29МБ 100МБ 200МБ;

         ленты 5010, 5017 и т.д.;

         АЦПУ и ридер;

         дисплей 7920;

         системная консоль.

         Диски и  ленты эмулируются  как некоторые  файлы с внутренней
    организацией, необходимой для работы эмулируемых устройств (TM для
    лент; собственный адрес и т.п. для дисков).

         Для  работы  с  физической  лентой  возможно подключение PC к
    лентопротяжному устройству СМ за дополнительную плату.

         Дисплеи эмулируются на уровне экрана монитора PC.

         Дисплеи  7920  эмулируются  на  уровне локальной сети (работа
    через NETBIOS).

         АЦПУ и ридер эмулируются последовательными файлами MS DOC.

         Отличие в эмуляции от ЕС ЭВМ:

         не реализованы команды IBM 370 работы с виртуальной памятью;

         плавающая точка вся реализована с двойной точностью;

         таймер ЦПУ выполняет отсчет синхронно с эмуляцией команд,  а
    не независимо от них;

         не реализован компаратор;

         часы идут с 10% несинхронизацией по отношению к часам PC;

         Быстродействие проверено на 486DX2 66MHz ~~ 300 тыс  операций
    в секунду эмулируемой ЭВМ.





                  1. Установка программного обеспечения
                  =====================================

         Создайте  любую  директорию  достойную  для  размещения в ней
    программы эмулятора и скопируйте в нее все файлы с  дистрибутивной
    дискетты.

    Например:

    C:>md 360<ENTER>
    C:>cd 360<ENTER>
    C:\360>copy a:*.* c:\360\*.*<ENTER>  <--в случае размещения
                                            дистрибутивной дискеты
                                            в дисководе A:

         Немедленно после  этого создайте  резервную копию  полученной
    дистрибутивной  дискеты  и  сохраните  оригинал  в  защищенном  от
    прямого попадания солнечных лучей, прохладном месте.

    Например:

    C:>diskcopy a: a:                    <--в случае размещения
                                            дистрибутивной дискеты
                                            в дисководе A:


         Сразу  после  копирования  программное  обеспечение  готово к
    работе. Вы можете сразу запустить ЭМУЛЯТОР, набрав имя выполнимого
    модуля:

    C:\360>dst360p


            1.а Защита от несанкционированного использования
            ================================================

         Программное   обеспечение,   полученное   Вами,   защищено от
    несанкционированного  копирования.  После  сброса   дистрибутивной
    дискетты в Вашей директории находится файл DS360CH2.EXE, запустите
    этот модуль:

    C:\360>ds360ch2<ENTER>

         В   результате   выполнения   программы   контрольные  суммы,
    характеризующие Ваш компьютер, будут выданы на экран монитора:


    CHECK STRING:
    ead404990230322f31392f383800fc00
    ВВЕДИТЕ ПРИЧИНУ ЗАПУСКА ПРОГРАММЫ DS360CH2 (ИЛИ ENTER):<ENTER>










         Аналогичная информация будет выведена и в файл HISTORY:

      DATE OF INSTALATION=Wed Jan 25 11:51:33 1995
      INSTALATION REASON:
      LN=ead404990230322f31392f383800fc00
      ************************************************

         Сообщите полученную на экране монитора строку (или содержимое
    файла   HISTORY)   дилеру,   выполняющему   поставку  программного
    обеспечения. Он подскажет  как скорректировать файл  INIT360.PRM с
    тем, чтобы  защита от  несанкционированого использования  работала
    корректно.

         Надо отметить, что вся эта процедура необходима Вам, когда  в
    силу  технических  причин  Вы  изменили  конфигурацию Вашего ПК, в
    случае первоначальной установки специалист, выполняющий установку,
    проведет данную процедуру самостоятельно.

         После   корректировки   файла   INIT360.PRM   все  содержимое
    директории с модулями ЭМУЛЯТОРА может быть произвольно  копировано
    в рамках данной вычислительной установки.

         Правильность   установки   защиты   от   несанкционированного
    использования можно  проверить, запустив  ЭМУЛЯТОР и  убедившись в
    отсутствии сообщения, о НЕЗАРЕГИСТРИРОВАННОЙ КОПИИ ПРОГРАММЫ.

         ВНИМАНИЕ! Ни в коем случае не пытайтесь изменять  загрузочные
    модули программы.  Если вдруг  у Вас  в результате  вирусной атаки
    модуль  оказался  ЗАПОРЧЕН,  Вам  достаточно  восстановить  его из
    архива.

         ВЫ   МОЖЕТЕ   ПРОИЗВОЛЬНО   КОПИРОВАТЬ   ДАННОЕ   ПРОГРАММНОЕ
    ОБЕСПЕЧЕНИЕ НА ЛЮБЫЕ ДРУГИЕ КОМПЬЮТЕРЫ, ОТДАВАТЬ ЕГО ЛЮБЫМ ТРЕТЬИМ
    ЛИЦАМ.  В  ЭТОМ  СЛУЧАЕ  ПЕРЕДАВАЕМАЯ  ИЛИ  ПЕРЕМЕЩАЕМАЯ  КОПИЯ ИЗ
    РАБОЧЕЙ  ПРЕВРАЩАЕТСЯ  В  ДЕМОНСТРАЦИОННУЮ  СО  ВСЕМИ  ВНУТРЕННИМИ
    ОГРАНИЧЕНИЯМИ,   ПРИСУЩИМИ   ДЕМОНСТРАЦИОННОЙ   ВЕРСИИ.   ОБРАТНОЕ
    ПРЕВРАЩЕНИЕ  ДЕМОНСТРАЦИОННОЙ  ВЕРСИИ  В  РАБОЧУЮ   ОСУЩЕСТВЛЯЕТСЯ
    ЛЕГКИМ ДВИЖЕНИЕМ РУКИ - ЗВОНОКОМ ВАШЕМУ ДИЛЕРУ.





















                2. Настройка файла параметров INIT360.PRM
                ========================================

         Существенным и  важным является  модуль INIT360.PRM,  который
    выполняет настройку устройств ЭМУЛЯТОРА.

    Рассмотрим его:

==========================начало файла==========================
SERIAL NUMBER=SDRIT1OEGY0
DATE OF REGISTRATION=Thu Sep 15 11:27:01 1994
REGISTRATION REASON:NOTEBOOK EVEREX DSSOFT
*************************************************************
LN=ead404990230322f31392f383800fc000006a1f800306934
ВСЕ СТРОКИ ВЫШЕ ДАННОЙ НЕ МОГУТ БЫТЬ ИЗМЕНЕНЫ БЕЗ
РАЗРЕШЕНИЯ РАЗРАБОТЧИКА
ЛЮБОЕ ИХ ИЗМЕНЕНИЕ МОЖЕТ ВЫЗВАТЬ НЕПРЕДСКАЗУЕМЫЙ РЕЗУЛЬТАТ В РАБОТЕ ЭМУЛЯТОРА
*************************************************************
IO=01F,CONS,XXX.01F
IO=00C,RDR ,LISTCOPY.00C
IO=00A,rdr ,IPL.000
IO=00E,PRN ,PRINTER.OUT
*************************************************************
*2311(7.25MB) CYL=203 TRK=9 BYTE=3625 MAX=4000
*5061(29MB)   CYL=203 TRK=20 BYTE=7294 MAX=8000
*    (200MB)  CYL=818 TRK=20 BYTE=13030 MAX=14000
*************************************************************
IO=232,DASD/CYL=203/TRK=20/BYTE=7294/MAX=8000,C:\DISK\MVT617.DSK
*IO=284,TYPE,C:\TYPE\CBC1.TYP
IO=0C0,7920,XXX.0C0
*IO=0C1,7920,XXX.0C1
IO=00D,PRN ,XXX.00D
=================================конец файла====================

         Первые десять строк (как сказано в коментариях) не могут быть
    изменены без ведома дилера.

         Остальные строки  этого файла  делятся на  коментарии (символ
    '*' в первой позиции)  и строки описания устройств.  Формат строки
    описания следующий:

    IO=xxx,yyyy[disk-parametres],file-name

    где:
==>>xxx      - адрес устройства (3 символа)
==>>yyyy     - тип устройсва (4 символа), принимает следующие
               значения:
        CONS - пишущая машинка 1052. ВНИМАНИЕ: ПМ ВСЕГДА ДОЛЖНА БЫТЬ
        ====                         ===============================
               ПЕРВЫМ УСТРОЙСТВОМ в файле
               ==================

        RDR  - перфокарточный ввод 2502/2520/1442 и т.д.
        ====   При считывании перфокарты, строка файла
               дополняется до 80 байт пробелами (или урезается до 80
               байт), перекодируется в код EBCDIC и передается
               ЭМУЛЯТОРУ.




        rdr  - тот же перфокарточный ввод, но без перекодировки
        ====   (должен быть в коде EBCDIC) и строками по 80 байт.
               Данный тип устройства может быть использован для
               загрузки системно-независимых утилит.

        PRN  - АЦПУ
        ====   При выдаче строки в выходной файл производится
               перекодировка из кода EBCDIC в ASCII.

        prn  -  то же АЦПУ, но перекодировка не производится
        ====

        7920 -  дисплей 7920
        ====

        TYPE -  лентопротяжное устройство 5010/5017/ и т.д.
        ====

        5010 -  подключаемое к ПК лентопротяжное устройство (СМ)
        ====


        DASD - дисковое устройство
        ====

        AAAA      -дополнительные устройства пользователя (в случае
        BBBB       поставки с возможностью дополнительного расширения)
                   При этом Вы сами должны создать модули обработки
                   команд устройства DS360UNA.C, DS360UNB.C,
                   в соответствии с коментариями, приведенными в этих
                   модулях

==>>[disk-parametres] - параметры дискового накопителя
                        Параметры начинаются с символа '/' и принимают
                        следующие значения:

      /CYL=NNN     - количество цилиндров дискового накопителя
      /TRK=NNN     - количество треков на цилиндре
      /BYTE=NNNN   - количество байт на треке по пасторту данного типа
                     устройства
      /MAX=NNNN    - максимальное количество байт на треке (с учетом
                     эмуляции больше, чем паспортное)

    Рекомендуемые значения для разных типов устройств

    ====================================================
    тип        емкость     CYL     TRK     BYTE   MAX
    ====================================================
    2311       7.25        203     10      3625  4000
    2314/5061  29.         203     20      7296  8000
    5067.02    100.        414     20     13030 14000
    5067.--    200.        818     20     13030 14000
    5063       317.       1024     30     13030 14000
    ====================================================







         Как  видите  можно  указать  различные  значения   параметров
    дисков. Самое главное: количество цилиндров, треков и размер трека
    (параметр  /BYTE)  должно  быть  не  меньше  реального количества.
    Параметр  /MAX  должен  быть  не  меньше,  чем  на 300 байт больше
    реального размера трека.

==>>file-name - имя файла эмулируемого устройства. Пишется согласно
                правил MS-DOS, однако все имена, пути доступа, имена
                дисков ДОЛЖНЫ БЫТЬ ЗАГЛАВНЫЕ



                      3. Назначение рабочих файлов
                      ============================

         Заглянем  в  директорию,  содержащую  наши  программы.  После
    запуска ЭМУЛЯТОРА в ней добавились некоторые файлы. Разберемся  со
    старыми файлами и  попытаемся понять, как  нам могут быть  полезны
    новые.


     DS360MKD.EXE - модуль создания файла эмулируемого диска
     DS360MKD.DSK - рабочий файл модуля DS360MKD.EXE
     DS360MKD.C   - исходный текст модуля DS360MKD.EXE
     DS360CH2.EXE - модуль поддержки защиты от несанкционированного
                    доступа
     DS360TAP.C   - исходный текст программы конвертации двоичного
                    файла, переброшенного  с ЕС ЭВМ, в формат
                    эмулируемой ленты
     DS360TAP.EXE - загрузочный модуль программы конвертации
     DST360P.EXE  - модуль эмулятора. Параметры эмулируемой ЭВМ
                    (оперативная память, тип 360/370, отладка, тип
                    целевого компьютера 386/486/387/NO NPU) задаются и
                    генерируются по желанию пользователя. В общем
                    случае могут быть сгенерированы несколько модулей.
     DST360P.HLP  - файл подсказок (в принципе сообщения можно
                    перевести на турецкий язык и подключит в
                    праграму)
     INIT360.PRM  - файл настроек устройств
     MEMORY       - слепок оперативной памяти
     STATUS       - Внутренние переменные, используемые в работе
                    процессора ЕС ЭВМ
     TYPE.284     - Файл состояния лентопротяжного устройства с
                    соответствующим номером
     XXX.01F      - Твердая копия консоли (имя файла указано в
                    INIT360.PRM). При каждом запуске ЭМУЛЯТОРА в
                    момент вывода на ПМ строк,они дописываются в файл
                    твердой копии. Переполнения файла никогда не
                    происходит,поэтому рекомендуется при большом
                    размере файла твердой копии его периодически
                    удалять.
     XXX.0C0      - содержимое экрана дисплея с соответствующим
                    адресом (имя файла указано в INIT360.PRM)
     PRINTER.OUT  - выходной файл принтера (имя указано в INIT360.PRM)





          4. Запуск эмулятора и переключение работы его режимов
          =====================================================

    Для запуска ЭМУЛЯТОРА просто наберите имя загрузочного модуля:

    C:\360>dst360p<ENTER>

         Никакие  параметры  не  требуются.
                                 ----------------------
                                 |          DST360P   |
                     ----------  |                    |
                     |  XMS   |  |   ---------------  |
         MEMORY ---> |        |  |   |  процессор  | <------ STATUS
                     | ОП 360 |  |   _______________  |
                     | 1024К/ |  |                    |
                     | XXXXK  |  |                    |
                     ----------  |                    |
         INIT360.PRM----------------> устройства      |
                                 |--------------------|
                                 | DISK | TAPE | RDR  |
                                 ----------------------
                    -------------->         A       A
                    |                       |       |
           C:\DISK\MVT617.DSK               |       |
                               C:\TAPE\TAPE1.TYP    |
                                                    |
                                                   LISTCOPY.00C


         После запуска ЭМУЛЯТОР: считывает файл INIT360.PRM, выполняет
    настройку устройств,  загружает файл  слепка ОП  MEMORY в extended
    memory, загружает внутренние регистры процессора из файла STATUS и
    выдает на экран следующее:


=========================начало сообщения============================
INITIALISATION XMS:
END-OFF-INITIALISATION XMS.

 UNIT=01f  TYPE=C
 UNIT=00c  TYPE=R
 UNIT=00a  TYPE=r
 UNIT=00e  TYPE=P
 UNIT=232  TYPE=D  CYL=cb TRK=14 BYTE=7294 MAX=8000
 UNIT=0c0  TYPE=7
 UNIT=00d  TYPE=P











 



┌─────────────────────────────────────────────────────────────────────────────┐
│                                           ▄▄▄▄  ▄▄▄▄▄▄   ▄▄▄   ▄▄▄          │
│ Emulator               Ver.1.5             ▄▄    ▄▄  ▄▄   ▄▄▄ ▄▄▄           │
│                                            ▄▄    ▄▄▄▄▄    ▄▄ ▄ ▄▄           │
│                                            ▄▄    ▄▄  ▄▄   ▄▄   ▄▄           │
│  for AT/386 /486                          ▄▄▄▄  ▄▄▄▄▄▄   ▄▄▄▄ ▄▄▄▄    360   │
├─────────────────────────────────────────────────────────────────────────────┤
│ CSW █ ▒ █ █ █ ▒ ▒ █ █ █ ▒ ▒ █ █ ▒ █ █ █ █ ▒ █ ▒ ▒ ▒ █ ▒ ▒ █ █ ▒ ▒ █ ▒ █ █   │
├─────────────────────────────────────────────────────────────────────────────┤
│ PSW █ █ █ ▒ ▒ █ █ █ █ ▒ █ █ █ █ █ █ █ ▒ █ ▒ █ ▒ █ █ █ ▒ ▒ █ ▒ ▒ ▒ █ ▒ ▒ █   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                       ╔═╗╔═╗╔═╗      ╔═══╗  │
│ SERIAL NUMBER=SDRIT1OEGY0               IPL Adress    ║X║║X║║X║      ║IPL║  │
│                                                       ╚═╝╚═╝╚═╝      ╚═══╝  │
└─────────────────────────────────────────────────────────────────────────────┘

 РЕЖИМ ПУЛЬТА ОПЕРАТОРА (ВЫХОД ИЗ ПРОГРАММЫ: ESC)

 ПОДКЛЮЧИТЕСЬ К ТЕРМИНАЛУ ИЛИ КОНСОЛИ ОПЕРАТОРА
==> F1 01f C 00         XXX.01F
==> F2 0c0 7 00         XXX.0C0
 FN - ПОДКЛЮЧИТСЯ К УСТР, TAB - К ПУЛЬТУ ЭВМ, (ESC - ВЫХОД ИЗ ПОДКЛЮЧЕНИЯ)
========================окончание сообщения==========================

         Таким образом,  сразу после  запуска Вы  находитесь в  режиме
    подключения к устройствам отображения или пульту ЭВМ. Нажмите  TAB
    и Вы подключитесь к пульту ЭВМ:


========================начало сообщения=============================
УСТАНОВЛЕН РЕЖИМ ПУЛЬТА ЭВМ (ВЫХОД ИЗ ПРОГРАММЫ: ESC)
========================окончание сообщения==========================

         Надо отметить,  что переключение  режимов между  ПУЛЬТОМ ЭВМ,
    ПИЩУЩЕЙ  МАЩИНКОЙ  и  ДИСПЛЯМИ  подчиняется  следующим  правилам и
    каждый  из  режимов  Вы  визуально  можете  различить  по  цветам:
    ЗЕЛЕНЫЙ-7920, БЕЛЫЙ на  ЧЕРНОМ фоне- ПУЛЬТ  ЭВМ и ЧЕРНЫЙ  на БЕЛОМ
    фоне- П/М:

    1.ПУЛЬТ ЭВМ --> F1 - подсказка
    |           -->    - другие режимы доступнык с пульта ЭВМ
    |       A   --> i  - загрузка ---> 232<ENTER>-------------------|
    |       |   --> F10 -переключение либо к дисплею либо к П/М     |
    V       |           |                                           |
  ESC       |           |-->F1 [П/М 01F]---->ESC  выход   -----|    |
  выход     |           |        A     |---->TAB = КЛ ВНИМ--|  |    |
  из        |           |        |--------------------------|  |    |
  эмулятра  |           |                                      |    |
            |           |-->F2 [7920 0C0]------>ESC  выход ----|    |
            |                                                  |    |
            |-------------------------------------------------------|










    То есть если нажать ESC, то происходит выход из программы:

========================начало сообщения=============================
Pressed-ESC: EXIT request
Are you sure? (Y/N)<Y>
 Wait Please

[s[u                    НАЖАТА КЛАВИША ESC - ЗАПРОС НА ВЫХОД
STORING XMS:
END-OFF-STORING XMS.
========================окончание сообщения==========================

         Однако  бывают  случаи,  когда  Вам  необходимо первоначально
    проинициализировать оперативную память и процессор. В этом  случае
    можно задать специальный параметр при запуске программы.


    C:\360>dst360p i<ENTER>

         ЭМУЛЯТОР  полностью  проинициализирует  ОП  и  процессор. При
    таком  режиме  можно  даже  предварительно  удалить файлы STATUS и
    MEMORY - ЭМУЛЯТОР повторно их создаст.




                      4.а Режим эмуляции пульта ЭВМ
                      =============================

         В режиме ПУЛЬТА ЭВМ любое нажатие на клавишу интерпретируется
    как некоторая команда. Допустимые команды:


     ESC   - закрыть оперативную память и устройства и выйти из
             ЭМУЛЯТОРА.
     Q     - закрыть оперативную память и выйти без сохранения статуса
             устройств (удобен, если не удается выйти с помощью ESC)
     I     - начальная загрузка программы
     D     - просмотреть ОП
     X     - просмотреть ОП в XXXX виде
     R     - просмотреть содержимое регистров и PSW
     TAB   - нажатие на клавишу ЗАПРОС на П/М (ПМ должна быть первым
             устройством в INIT360.PRM
     F10   - переключится на терминал или на П/М
     B     - просмотреть содержимое плавающих регистров
     W     - записать слово в оперативную память
     S     - остановить трассоровку
     <ENTER>- в режиме трассировки выполнить следующую команду
     T     - включить трассу (возможны разные режимы)
     F     - продолжиться до следующей трассируемой команды
     F9    - смоделировать состояние READY (сгенерировать прерывание)
             для устройств







     F5    - показать состояние обмена для устройств (для диска
             CYL/TRK, для ленты - указатель записи, RDR -содержимое
             строки, WTR-содержимое выводимое на печать)
     F4    - отменить просмотр (алтернативен F5)

         Одновременно с этим режим ПУЛЬТА ЭВМ позволяет эмулировать  и
    П/М:  все  что  выводиться  на  П/М  в  режиме  ПУЛЬТА  ЭВМ  сразу
    появляется на экране. Кроме  этого для совместимостью с  эмуляцией
    П/М имеется команда <TAB> - эмуляция нажатия на клавишу ЗАПРОС  на
    П/М.

         Режим  ПУЛЬТА  ЭВМ  можно  легко  отличить  по цвету - строки
    появляются БЕЛЫМИ на ЧЕРНОМ фоне.


               4.б Режим эмуляции консоли оператора (П/М)
               ==========================================


         В режим ЭМУЛЯЦИИ П/М можно попасть из режима ЭМУЛЯЦИИ ПУЛЬТА,
    нажав команду  F10 -  переключение на  терминал или  П/М и  выбрав
    соответствующее устройство.

         Сразу после  выбора режима  на экран  будет выдано предыдущее
    содержимое твердой копии.

         Переключившись  на  П/М   Вы  увидите,  как   изменится  цвет
    выводимых сообщений - ЧЕРНЫЙ на БЕЛОМ фоне.

         Для эмуляции нажатия  на клавишу ЗАПРОС  используется клавиша
    TAB.

         Для выхода из режима эмуляции П/М используется клавиша ESC.


                     4.в Режим эмуляции дисплея 7920
                     ===============================

    Режим эмуляции 7920 аналогично П/М доступен из ПУЛЬТА ЭВМ путем
    команд F10 - переключение на терминалы и затем выбор терминала.
    Сразу появляется изображение экрана монитора (зеленый цвет).
    Работы и редактирование выполняется аналогично реальному 7920.
    Нажатие на клавиши <ENTER> <F1>-<F10> эквивалентен аналогичным
    клавишам 7920.

    Клавиша ESC - завершает режим ЭМУЛЯЦИИ 7920.


       5. Переброска программного обеспечения с ЕС ЭВМ в эмулятор
       ==========================================================









         Переброска   программного   обеспечения   выполняется   через
    магнитную  ленту.  Используя  ленту,  можно  выгрузить  диск   или
    библиотеку,  затем  последовательный   файл  переместить  на   ПК,
    преобразовать в  файл аналогичный  ленте и  восстановить диск  или
    библиотеку  на  диске.  Предварительно  нужно подготовить сам файл
    эмулируемого диска (приготовить его к работе).


       5.а Подготовка эмулируемых дисков
       =================================

         Создание  файла   диска  выполняется   с  помощью   программы
    DS360MKD. Исходный текст которого  приведен на языке С.  Программа
    использует файл  DS360MKD.DSK в  качестве образца  содержания 0-ой
    дорожки диска. Для вызова программы достаточно набрать:


 ds360MKD <FILE-OUT> <CYL> <TRK> <BYTE> <MAX_BYTE> <VOL-NAME 6 digits>

    где:

    <FILE-OUT>  - имя создаваемого файла эмулируемого диска
    <CYL>       - количество цилиндров
    <TRK>       - количество дорожек на цилиндре
    <BYTE>      - количество байт (емкость) дорожки
    <MAX_BYTE>  - должно быть больше на 300 байт, чем предыдущее
                  значение
    <VOL-NAME>  - имя тома




                    5.а Переброска дисковых носителей
                    =================================

         Выполните  системно  независимой  утилитой выгрузку дискового
    накопителя.  Полученный  последовательный  файл  разными способами
    может быть перемещен на ПК. Основная сложность заключается в  том,
    что в таком  файле отсутствует информация  о длине каждой  записи.
    Поэтому  предварительно   необходимо  обработать   такой  файл   и
    поместить в него перед каждой записью дескриптор, содержащий длину
    записи. Поэтому создайте такую  программу и воспользуйтесь ею  для
    обратотки файла и только затем перебрасывайте файл на ПК.

         После переброски запустите утилиту преобразования:

    DS360TAP <in-file> <out-file>

     INPUT BLKSIZE (5 цифр!!!!):11111
                                =====
     INPUT LRECL (5 цифр!!!!):11111
                              =====
     INPUT RECFM (VS)-LOAD LIB (FB)-SOURCE:VS
                                           ==
     INPUT TAPE LABEL (FILE ONLY==2) (SL-с метками) (NL-без меток):NL
                                                                   ==






         Утилита создает выходной файл эквивалентный файлу на ЕС  ЭВМ.
    Создается лента без  меток, на которой  наш файл находится  на ней
    под номером (LABEL=2).

         Остается запустить такую же системно-независимую утилиту,  но
    под ЭМУЛЯТОРОМ.

                5.б Переброска файлов на магнитной ленте
                ========================================

         Аналогичная ситуация как и при переброске диска возникает при
    перемещении  файлов,  выгруженных  различными  утилитами ОС. Файлы
    получаются  последовательные,  но  с  неизвестной  длиной   каждой
    записи. Поэтому предварительно необходимо обработать такой файл  и
    поместить  перед  каждой  записью  дескриптор.  Только после этого
    этапа файл можно переносить в двоичном виде на ПК.

         После  переноса  необходимо  запустить утилиту преобразования
    двоичного файла в файл эмулируемой ленты.

    DS360TAP <in-file> <out-file>

     INPUT BLKSIZE (5 цифр!!!!):03604  <-из справки ленты
                                =====
     INPUT LRECL (5 цифр!!!!):03600  <--из справки ленты
                              =====
     INPUT RECFM (VS)-LOAD LIB (FB)-SOURCE:FB <--из справки ленты
                                           ==
     INPUT TAPE LABEL (FILE ONLY==2) (SL-с метками) (NL-без меток):SL
                                                                   ==

         В результате создается файл эмулируемой ленты с именем 111111
    и одним файлом (LABEL=1) с именем A.



       5.в Программа формирования дескрипторов на ЕС ЭВМ
       =================================================

         Написание  такой  программы  возможно  разными способами, что
    связано с вопросами переброски на реальной ЭВМ реальных  массивов.
    Поэтому изложим основные правила такого преобразования:

    Исходный файл:
    <rec-1-len=200><rec-2-len-1200><rec-3-len-333><TM>
    Результирующий файл:
    <D-200><rec-1-len=200><D-1200><rec-2-len-1200><D-333><rec-3-len-333><TM>
    каждый дескриптор имеет длину 2-байта












          5.г Программа преобразования двоичного файла в формат
          =====================================================
                            эмулируемой ленты
                            =================

         Программа преобразования двоичного файла после переброски  на
    ПК обрабатывает его, помещает ленточную марку, упаковывает  каждую
    запись в формат ленты формирует имена и прочее.

         Сам исходный текст помещен на дистрибутивную дискету.

